{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://connect.informatik.uni-ulm.de/coordination/taf-implementation/-/tree/main/TAF_External_Interfaces/Messaging/AIV_SUBSCRIBE_REQUEST/",
    "title": "AIV_SUBSCRIBE_REQUEST",
    "type": "object",
    "properties": {
      "subscribe": {
        "type": "array",
        "description" : "A non-empty list of trustee devices and associated claims as subscription targets.",
        "items": {
            "type": "object",
            "description" : "A query record with trustee identifier and claims.",
            "properties": {
              "TrusteeID": {
                "description" : "The identifier of the trustee from which claims should be reported.",
                "type": "string"
              },
              "requestedClaims": {
                "description" : "A list of specific claims that are requested. If empty, all available claims should be reported.",
                "type": "array",
                "items": {
                    "type": "string"
                  },
                "minItems": 0
              }
            },
            "required": [
              "TrusteeID",
              "requestedClaims"
            ]
          },
          "minItems": 1
      },
      "checkInterval": {
        "type": "integer",
        "description" : "The time interval (in ms) in which the TAF assumes the AIV to check the claims periodically."
      },
      "evidence": {
        "type": "object",
              "properties": {
                  "timestamp": {
            "description": "Request creation date in UTC. To be provided by the TAF crypto library.",
                      "type": "string"
                  },
                  "nonce": {
                      "description": "Challenge in HEX format. To be provided by the TAF crypto library.",
                      "type": "string"
                  },
                  "signatureAlgorithmType": {
                      "description": "Signing algorithm. To be provided by the TAF crypto library.",
                      "type": "string"
                  },
                  "signature": {
                      "description": "Signature of the query structure and the rest of the evidence attributes. To be provided by the TAF crypto library.",
                      "type": "string"
                  },
                  "keyRef": {
                      "description": "Identifier to the public key associated with the TAF component. To be provided by the TAF crypto library.",
                      "type": "string"
                  }
              },
              "required": [
                  "timestamp",
          "nonce",
                  "signatureAlgorithmType",
                  "signature",
                  "keyRef"
              ]
          },
      "attestationCertificate" : {
        "description": "The certificate (*base64 string*) issued by the IAM, attesting to the correct execution of the TAF within an enclave.",
        "type": "string"
      }
    },
    "required": [
      "subscribe",
      "checkInterval",
      "evidence",
      "attestationCertificate"
    ]
  }