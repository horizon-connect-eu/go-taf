{
	"$schema": "http://json-schema.org/draft-07/schema#",
    "$wrapper": "https://connect.informatik.uni-ulm.de/coordination/taf-implementation/-/tree/main/TAF_External_Interfaces/Messaging/GENERIC_SUBSCRIPTION_NOTIFY/",
	"$id": "https://connect.informatik.uni-ulm.de/coordination/taf-implementation/-/tree/main/TAF_External_Interfaces/Messaging/AIV_NOTIFY/",
	"title": "AIV_NOTIFY",
	"type": "object",
	"properties": {
		"subscriptionId": {
			"description":"The unique identifier used for linking notifications with a specific subscription.",
			"type": "string",
			"$origin": "@subscribe#subscriptionId"
		},
		"trusteeReports": {
			"description": "",
			"type": "array",
			"items": {
				"type": "object",
				"properties": {
					"trusteeID": {
						"description": "The identifier of the trustee from which claims should be reported.",
						"type": "string"
					},
					"attestationReport": {
						"description": "A list of specific claims that are requested. If empty, all available claims should be reported.",
						"type": "array",
						"items": {
							"type": "object",
							"properties": {
								"claim": {
									"description": "",
									"type": "string"
								},
								"timestamp": {
									"description": "Date",
									"type": "string"
								},
								"appraisal": {
									"description": "Verification status based on the attestation mechanisms. Possible values: \n Value 0: The verifier (i.e., AIV) asserts that the attestation process has failed for a specific claim.\n Value 1: The verifier (i.e., AIV) affirms that a specific claim has been successfully verified. \n Value -1: The verifier (i.e., AIV) hasn't engaged in an attestation process for this specific claim (e.g., because the attestation process is not supported or the prover ECU is not responding). Note that this could be treated equivalently by TAF as no claim being made.\nValue -2: The verifier (i.e., AIV) initiated an attestation process but didn't receive the expected evidence from the prover entity (e.g., request timeout, malformed response).",
									"type": "integer",
									"enum": [
										-2,
										-1,
										0,
										1
									]
								}
							},
							"required": [
								"claim",
								"appraisal",
								"timestamp"
							]
						},
						"minItems": 0
					}
				}
			}
		},
		"aivEvidence": {
			"type": "object",
			"properties": {
				"timestamp": {
					"type": "string"
				},
				"nonce": {
					"description": "In Hex.",
					"type": "string"
				},
				"signatureAlgorithmType": {
					"type": "string"
				},
				"signature": {
					"type": "string"
				},
				"keyRef": {
					"type": "string"
				}
			},
			"required": [
				"timestamp",
				"nonce",
				"signatureAlgorithmType",
				"signature",
				"keyRef"
			]
		}
	},
	"required": [
		"subscriptionId",
		"trusteeReports",
		"aivEvidence"
	],
    "$priorMessages": {
      "subscribe": "https://connect.informatik.uni-ulm.de/coordination/taf-implementation/-/raw/main/TAF_External_Interfaces/Messaging/AIV_SUBSCRIBE_RESPONSE/"
    }
}
